# 2026-01-17 开发日志

## [15:00:00] [修改]

**文件路径**：`miniprogram/app.json`

**改动说明**：
- 移除微信同声传译插件配置（WechatSI）
- 不再需要插件即可使用录音功能

**影响范围**：使用原生录音 API，无需插件申请

**下一步计划**：修改首页录音逻辑

---

## [15:05:00] [修改]

**文件路径**：`miniprogram/pages/home/index.js`

**改动说明**：
- 移除插件相关状态：voiceManager
- 新增状态：voiceUrl, recordingTime, recordingTimer
- 移除 initVoiceRecognition 方法
- 重写 onVoiceStart 方法：使用 wx.getRecorderManager 开始录音
- 重写 onVoiceEnd 方法：停止录音并上传到云存储
- 重写 onVoiceCancel 方法：取消录音并清理定时器
- 新增 uploadVoice 方法：上传音频文件到云存储
- 新增 onRemoveVoice 方法：删除已上传的录音
- 修改 onSubmit 方法：支持保存 voice_url
- 修改 onUnload 方法：清理录音定时器

**影响范围**：从语音转文字改为保存录音文件

**下一步计划**：更新 UI 界面

---

## [15:10:00] [修改]

**文件路径**：`miniprogram/pages/home/index.wxml`, `miniprogram/pages/home/index.wxss`

**改动说明**：
- 录音提示添加录音时长显示（recordingTime 秒）
- 新增录音预览区域（显示已录制语音）
- 新增录音删除按钮
- 修改提交按钮激活条件：content 或 voiceUrl 有一个即可
- 新增录音预览样式：图标 + 文字 + 删除按钮

**影响范围**：UI 支持录音文件的显示和删除

**下一步计划**：测试录音功能

---
