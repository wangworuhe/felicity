<view class="container">
  <!-- é¡¶éƒ¨æ—¥æœŸ -->
  <view class="header">
    <text class="date">{{currentDate}}</text>
    <text class="greeting">ä»Šå¤©è®°å½•äº†å—ï¼Ÿ</text>
  </view>

  <!-- è®°å½•è¡¨å• -->
  <view class="form">
    <!-- æ–‡å­—è¾“å…¥ + å·¥å…·æ  -->
    <view class="input-wrapper">
      <view class="input-box">
        <textarea
          class="content-input"
          placeholder="è®°å½•ä¸€ä¸ªå¼€å¿ƒçš„ç¬é—´..."
          placeholder-class="placeholder"
          value="{{content}}"
          bindinput="onContentInput"
          maxlength="500"
          show-confirm-bar="{{false}}"
          fixed="{{true}}"
        />
      </view>

      <!-- åº•éƒ¨å·¥å…·æ  -->
      <view class="input-toolbar">
        <view class="toolbar-left">
          <!-- å›¾ç‰‡æŒ‰é’® -->
          <view
            class="tool-btn image-btn {{imageUrl ? 'has-image' : ''}}"
            bindtap="onChooseImage"
          >
            <text class="tool-icon">ğŸ“·</text>
          </view>

          <!-- è¯­éŸ³æŒ‰é’® -->
          <view
            class="tool-btn voice-btn {{isRecording ? 'recording' : ''}}"
            bindtouchstart="onVoiceStart"
            bindtouchend="onVoiceEnd"
            bindtouchcancel="onVoiceCancel"
          >
            <text class="tool-icon">{{isRecording ? 'ğŸ¤' : 'ğŸ™ï¸'}}</text>
          </view>
        </view>

        <!-- å­—æ•°è®¡æ•° -->
        <view class="char-count">
          <text>{{content.length}}/500</text>
        </view>
      </view>
    </view>

    <!-- å½•éŸ³æç¤º -->
    <view class="recording-tip" wx:if="{{isRecording}}">
      <text>æ­£åœ¨å½•éŸ³ {{recordingTime}}sï¼Œæ¾å¼€ç»“æŸ</text>
    </view>

    <!-- å·²ä¸Šä¼ å½•éŸ³é¢„è§ˆ -->
    <view class="voice-preview" wx:if="{{voiceUrl}}">
      <view class="voice-info">
        <text class="voice-icon">ğŸ¤</text>
        <text class="voice-text">å·²å½•åˆ¶è¯­éŸ³</text>
      </view>
      <view class="voice-remove" bindtap="onRemoveVoice">
        <text>Ã—</text>
      </view>
    </view>

    <!-- å·²ä¸Šä¼ å›¾ç‰‡é¢„è§ˆ -->
    <view class="image-preview" wx:if="{{imageUrl}}">
      <image
        class="preview-image"
        src="{{imageUrl}}"
        mode="aspectFill"
      />
      <view class="image-remove" bindtap="onRemoveImage">
        <text>Ã—</text>
      </view>
    </view>

    <!-- ä½ç½®ä¿¡æ¯ -->
    <view class="location-group" wx:if="{{location}}">
      <text class="location-icon">ğŸ“</text>
      <text class="location-text">{{location.name || 'æœªçŸ¥ä½ç½®'}}</text>
    </view>

    <!-- æäº¤æŒ‰é’® -->
    <button
      class="submit-btn {{content || voiceUrl ? 'active' : ''}}"
      bindtap="onSubmit"
      disabled="{{!content && !voiceUrl || submitting}}"
      loading="{{submitting}}"
    >
      {{submitting ? 'è®°å½•ä¸­...' : 'ä¿å­˜å¹¸ç¦'}}
    </button>
  </view>

  <!-- åº•éƒ¨å¯¼èˆª -->
  <view class="footer">
    <view class="footer-item" bindtap="goToRecords">
      <text class="footer-icon">ğŸ“</text>
      <text class="footer-text">æŸ¥çœ‹è®°å½•</text>
    </view>
    <view class="footer-item" bindtap="goToRandom">
      <text class="footer-icon">ğŸ²</text>
      <text class="footer-text">éšæœºå›é¡¾</text>
    </view>
  </view>
</view>
